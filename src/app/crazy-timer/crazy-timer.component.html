<div [class.sinister-theme]="isSinister" class="clown-theme">
  <!-- –§–æ–Ω–æ–≤—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ –∫—Ä–∞—è–º -->
  <div *ngIf="showPhotoBoard" class="photo-board">
    <div *ngFor="let photo of photos; let i = index" class="photo-pin" [ngStyle]="getPhotoStyle(i)">
      <img [src]="photo" class="pinned-photo">
      <div class="pin"></div>
      <div class="pin-shadow"></div>
    </div>
  </div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
  <div class="content-container">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <header class="header">
      <h1 class="crazy-title">
        <span class="title-emoji">ü§°</span>
        –¢–∞–π–º–µ—Ä–æ—á–µ–∫
        <span class="title-emoji">üé™</span>
      </h1>
      <div class="cookie-counter" [class.glowing]="cookies > 0">
        üç™ √ó {{ cookies }}
      </div>
    </header>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ –∑–ª–æ–º —Ä–µ–∂–∏–º–µ -->
    <div *ngIf="isSinister" class="sinister-overlay">
      <div class="sinister-message">
        <h2 class="sinister-text">{{ currentMessage }}</h2>
        <div class="sinister-animation">
          <span>üíÄ</span>
          <span>üî•</span>
          <span>üëπ</span>
        </div>
        <p class="sinister-instruction">–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ –∏–∑ —ç—Ç–æ–≥–æ –∫–æ—à–º–∞—Ä–∞!</p>
      </div>
    </div>

    <!-- –ó–∞–¥–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞) -->
    <section class="pending-section" *ngIf="pendingTimers.length > 0 && isAdmin">
      <h2 class="section-title">–ó–∞–¥–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É ({{ pendingTimers.length }})</h2>

      <div class="timers-grid">
        <article *ngFor="let timer of pendingTimers" class="timer-card pending-card">
          <header class="timer-header">
            <h3>{{ timer.task }}</h3>
            <span class="status-badge pending">‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</span>
          </header>
          <div *ngFor="let timer of pendingTimers" class="pending-timer">
            <h3>{{ timer.task }}</h3>
            <div>–°—Ç–∞—Ç—É—Å: ‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ (ID: {{ timer.id }})</div>
          </div>
          <div class="timer-body">
            <div class="time-display">
              <span class="time-left">‚è≥ {{ timer.formattedTime }}</span>
            </div>
            <div class="difficulty-badge">
              –°–ª–æ–∂–Ω–æ—Å—Ç—å: {{ timer.difficulty }}üç™
            </div>
          </div>

          <footer class="timer-footer">
            <button (click)="approveTask(timer.id)" class="btn-approve">
              ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
            </button>
            <button (click)="rejectTask(timer.id)" class="btn-reject">
              ‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å
            </button>
          </footer>
        </article>
      </div>
    </section>

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞ -->
    <main class="main-content">
      <form #timerForm="ngForm" (ngSubmit)="addTimer(timerForm)" class="timer-form">
        <fieldset class="form-fieldset">
          <legend class="form-legend">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–∞–π–º–µ—Ä</legend>

          <div class="form-group">
            <label for="taskInput" class="form-label">–ó–∞–¥–∞—á–∞:</label>
            <input id="taskInput"
                   [(ngModel)]="newTask"
                   name="task"
                   required
                   minlength="3"
                   placeholder="–ß—Ç–æ –∂–µ —Ç–µ–±–µ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?"
                   class="form-input clown-input">
          </div>

          <div class="form-group">
            <label for="timeAmount" class="form-label">–í—Ä–µ–º—è:</label>
            <div class="time-input-group">
              <input id="timeAmount"
                     type="number"
                     [(ngModel)]="timeAmount"
                     name="timeAmount"
                     required
                     min="1"
                     class="form-input number-input clown-input">
              <select [(ngModel)]="selectedUnit"
                      name="timeUnit"
                      class="unit-select clown-select">
                <option *ngFor="let unit of units" [value]="unit.value">
                  {{ unit.name }}
                </option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="difficultyRange" class="form-label">
              –°–ª–æ–∂–Ω–æ—Å—Ç—å: <span class="difficulty-value">{{ difficulty }}</span>üç™
            </label>
            <input id="difficultyRange"
                   type="range"
                   [(ngModel)]="difficulty"
                   name="difficulty"
                   min="0"
                   max="10"
                   step="1"
                   class="range-input clown-slider"
                   [style.--track-color]="'hsl(' + (difficulty * 36) + ', 100%, 50%)'">
          </div>

          <button type="submit"
                  class="submit-button clown-button"
                  [disabled]="!timerForm.valid"
                  [style.transform]="'rotate(' + getRandomValue(-3, 3) + 'deg)'">
            üéâ –î–û–ë–ê–í–ò–¢–¨ –ó–ê–î–ê–ù–ò–ï
          </button>
        </fieldset>
      </form>

      <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã -->
      <section class="timers-section" *ngIf="activeTimers.length > 0">
        <h2 class="section-title">–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è ({{ activeTimers.length }})</h2>

        <div class="timers-grid">
          <article *ngFor="let timer of activeTimers; trackBy: trackById" class="timer-card">
            <header class="timer-header">
              <h3>{{ timer.task }}</h3>
              <span *ngIf="timer.isPending" class="status-badge pending">‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</span>
              <span *ngIf="timer.isApproved" class="status-badge approved">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</span>
            </header>

            <div class="timer-body">
              <div class="time-display">
                <span class="time-left">‚è≥ {{ timer.formattedTime }}</span>
                <span class="original-time">
                  ({{ timer.originalAmount }} {{ getUnitName(timer.originalUnit) }})
                </span>
              </div>

              <div class="difficulty-badge">
                –°–ª–æ–∂–Ω–æ—Å—Ç—å: <span>{{ timer.difficulty }}</span>üç™
              </div>
            </div>
            <div *ngIf="isPending(timer.id)" class="status-badge pending">
              ‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
            </div>
            <div *ngIf="isApproved(timer.id)" class="status-badge approved">
              ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ
            </div>
            <footer class="timer-footer">
              <button (click)="completeTimer(timer.id)" class="complete-button clown-button">
                ‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å
              </button>
            </footer>
          </article>
        </div>
      </section>

      <!-- –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã -->
      <section class="completed-section" *ngIf="completedTimers.length > 0">
        <h2 class="section-title">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è ({{ completedTimers.length }})</h2>

        <div class="completed-list">
          <div *ngFor="let timer of completedTimers" class="completed-timer">
            <h3>{{ timer.task }}</h3>
            <div>–°—Ç–∞—Ç—É—Å: ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ (ID: {{ timer.id }})</div>
          </div>
        </div>
        <div *ngIf="isApproved(timer.id)" class="status-badge approved">
          ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ ({{ timer.id }})
        </div>
      </section>
    </main>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –¥–æ—Å–∫–∏ -->
  <button (click)="togglePhotoBoard()" class="toggle-board-button clown-button">
    {{ showPhotoBoard ? '–°–ø—Ä—è—Ç–∞—Ç—å –¥–æ—Å–∫—É' : '–ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å–∫—É' }}
  </button>
</div>
